(function(){var Events,Map,Singleton,equalHeight,root,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},_this=this;root=this;root.$=jQuery;if(typeof L!=="undefined"){root.L=L}Singleton=function(){function Singleton(){}Singleton.instance=null;Singleton.get=function(){var _ref;return(_ref=this.instance)!=null?_ref:this.instance=new this};return Singleton}();Events=function(_super){__extends(Events,_super);function Events(){_ref=Events.__super__.constructor.apply(this,arguments);return _ref}Events.mapImgClick=function(locationStr,mapObj,locationObj){$(".location #"+locationStr).click(function(){var h,loc,w;loc=$("#map-modal");w=$(window).width()*.8;h=$(window).height()*.6;loc.height(h).width(w).css("padding","15px");$("#locModal .modal-header h4").html(locationObj.title);locationObj.marker.addTo(mapObj);mapObj.panTo(locationObj.loc);return $("#locModal").modal().on("shown",function(){mapObj.invalidateSize(true)})})};return Events}(Singleton);if(typeof L!=="undefined"){Map=function(_super){__extends(Map,_super);Map.L=root.L;Map.L.Icon.Default.imagePath="/img/vendor";Map.ConfigItems={cloudmadeUrl:"http://{s}.mqcdn.com/tiles/1.0.0/osm/{z}/{x}/{y}.jpg",subDomains:["otile1","otile2","otile3","otile4"],cloudmadeAttrib:'Data, imagery and map information provided by <a href="http://open.mapquest.com" target="_blank">MapQuest</a>, <a href="http://www.openstreetmap.org/" target="_blank">OpenStreetMap</a> and contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/" target="_blank">CC-BY-SA</a>',tileLayerObj:{},layer:{},mapConfig:{}};Map.MapObjects={venue:{loc:new Map.L.LatLng(42.2446341,-72.0185379),str:'<div id="" class="vcard"><div class="org"><a href="http://www.zukas.com/">Zukas Hilltop Barn</a></div><div class="adr"><div class="street-address">89 Smithville Road</div><span class="locality">Spencer</span>,<span class="region">MA</span>,<span class="postal-code">01562</span></div><div class="tel">(508) 885-5320</div></div>',title:"Zukas Hilltop Barn",marker:{}},hotel:{loc:new Map.L.LatLng(42.113588,-72.089949),str:'<div id="" class="vcard"><div class="org"><a href="http://www.sturbridgehosthotel.com/">Sturbridge Host Hotel & Conference Center</a></div><div class="adr"><div class="street-address">366 Main Street</div><span class="locality">Sturbridge</span>,<span class="region">MA</span>,<span class="postal-code">01566</span></div><div class="tel">(508) 347-7393</div></div>',title:"Sturbridge Host Hotel &amp; Conference Center",marker:{}},locations:{},markerArgs:{}};Map.map={};Map.currentLoc="";Map.setMarkers=function(args){var loc;loc=args.loc;$.each(args.locations,function(){this.marker.bindPopup(this.str+'<a href="https://maps.google.com/maps?saddr='+loc+"&daddr="+this.daddr+'&z=9" target="_blank">Get directions</a>')})};Map.init=function(){Map.map.locate();Map.map.on("locationfound",Map.onLocationFound);Map.map.on("locationerror",Map.onLocationError);Map.setMarkers(Map.MapObjects.markerArgs)};Map.onLocationError=function(){return Map.setMarkers(Map.MapObjects.markerArgs)};Map.onLocationFound=function(e){Map.currentLoc=e.latlng.lat+", "+e.latlng.lng;Map.MapObjects.markerArgs.loc=Map.currentLoc;return Map.setMarkers(Map.MapObjects.markerArgs)};function Map(){Map.ConfigItems.tileLayerObj={maxZoom:18,attribution:Map.ConfigItems.cloudmadeAttrib,subdomains:Map.ConfigItems.subDomains,reuseTiles:true};Map.ConfigItems.layer=new this.L.TileLayer(Map.ConfigItems.cloudmadeUrl,Map.ConfigItems.tileLayerObj);Map.ConfigItems.mapConfig={zoom:13,layers:[Map.ConfigItems.layer],center:Map.MapObjects.venue.loc};Map.MapObjects.locations=this.L.layerGroup([Map.MapObjects.venue.loc,Map.MapObjects.hotel.loc]);Map.map=new this.L.Map("map-modal",Map.ConfigItems.mapConfig);Map.MapObjects.hotel.marker=this.L.marker(Map.MapObjects.hotel.loc);Map.MapObjects.venue.marker=this.L.marker(Map.MapObjects.venue.loc);Map.MapObjects.markerArgs={loc:"",locations:{hotel:{marker:Map.MapObjects.hotel.marker,str:Map.MapObjects.hotel.str,daddr:"Sturbridge+Host+Hotel+Sturbridge,+MA,+01566"},venue:{marker:Map.MapObjects.venue.marker,str:Map.MapObjects.venue.str,daddr:"Zukas+Hilltop+Barn+Spencer,+MA,+01562"}}};Map.ConfigItems.layer.addTo(Map.map);Map.init();return}return Map}(Singleton)}equalHeight=function(group){var tallest;tallest=0;group.each(function(){var thisHeight;thisHeight=$(this).height();if(thisHeight>tallest){return tallest=thisHeight}});return group.height(tallest)};root.$(function(){var flex;if($(window).width()>=768){equalHeight($(".about"))}flex={slideshow:true,directionNav:true,pauseOnHover:false,slideshowSpeed:5e3};$(".flexslider").flexslider(flex);if(typeof L!=="undefined"){Map();Events.mapImgClick("hotel",Map.map,Map.MapObjects.hotel);Events.mapImgClick("venue",Map.map,Map.MapObjects.venue)}})}).call(this);